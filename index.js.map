{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios'; \nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport let MAX_PAGE = 1;\n\nexport async function getImagesByQuery(query, page) {\n  axios.defaults.baseURL = 'https://pixabay.com';\n  const params = {\n    key: '49676421-fbb984ce693a0b40b5728e81f',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  };\n\n  try {\n    const res = await axios.get('/api/', { params });\n\n    const { total, totalHits, hits } = res.data;\n\n    // розрахунок максимальної сторінки\n    MAX_PAGE = Math.ceil(totalHits / params.per_page);\n\n    // якщо немає зображень\n    if (!hits || hits.length === 0) {\n      iziToast.warning({\n        title: '❌',\n        message: 'Sorry, no images match your search query. Please try again!',\n        color: 'red',\n        position: 'topRight',\n        messageColor: 'white',\n        titleColor: 'white',\n      });\n\n      return { total, totalHits, hits: [], error: null };\n    }\n\n    return { total, totalHits, hits, error: null };\n\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n\n    return { total: 0, totalHits: 0, hits: [], error: error.message };\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { MAX_PAGE } from './pixabay-api';\nimport iziToast from 'izitoast';\n\nconst spanEl = document.querySelector('.loader');\nconst ulElem = document.querySelector('.gallery');\nconst btnLdMrEl = document.querySelector('.load-more');\n\nif (spanEl) {\n  spanEl.hidden = true;\n}\n\nconst gallery = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt', // Вказуємо, що підписи братимуться з атрибута 'alt' зображення\n  captionDelay: 250, // Затримка появи підпису\n});\n\nexport function createGallery(images) {\n  const markup = templatesImage(images);\n  ulElem.insertAdjacentHTML('afterbegin', markup);\n\n  gallery.refresh();\n}\n\nexport function updateGallery(images) {\n  const markup = templatesImage(images);\n  ulElem.insertAdjacentHTML('beforeend', markup);\n\n  gallery.refresh();\n}\n\nexport function clearGallery() {\n  ulElem.innerHTML = ``;\n}\n\nexport function showLoader(currentPage) {\n  spanEl.hidden = false;\n  if (currentPage > 1) {\n    spanEl.classList.add('load-more-loader');\n  }\n}\n\nexport function hideLoader() {\n  spanEl.hidden = true;\n}\n\nexport function checkVisibleLoadBtn(currentPage) {\n  if (currentPage < MAX_PAGE) {\n    showLoadMoreButton();\n  } else if (MAX_PAGE) {\n    hideLoadMoreButton();\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      color: 'blue',\n      position: 'topRight',\n      messageColor: 'black',\n    });\n  }\n}\n\nexport function scrollAfterUpdate() {\n  const cardEl = ulElem.querySelector('.gallery-item');\n\n  let rect = cardEl.getBoundingClientRect();\n\n  window.scrollBy({\n    top: rect.height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction showLoadMoreButton() {\n  btnLdMrEl.classList.add('is-visible');\n}\n\nexport function hideLoadMoreButton() {\n  btnLdMrEl.classList.remove('is-visible');\n}\n\nfunction templateImage(img) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = img;\n  return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a><div class=\"stats\">\n  <p class=\"img-rates\">Likes<span>${likes}</span></p>\n  <p class=\"img-rates\">Views<span>${views}</span></p>\n  <p class=\"img-rates\">Comments<span>${comments}</span></p>\n  <p class=\"img-rates\">Downloads<span>${downloads}</span></p></div>\n</li>\n`;\n}\n\nfunction templatesImage(imgs) {\n  return imgs.map(templateImage).join('\\n');\n}\n","import { getImagesByQuery, MAX_PAGE } from './js/pixabay-api';\nimport {\n  checkVisibleLoadBtn,\n  clearGallery,\n  createGallery,\n  hideLoader,\n  scrollAfterUpdate,\n  showLoader,\n  updateGallery,\n  hideLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formEl = document.querySelector('.form');\nconst btnLdMrEl = document.querySelector('.load-more');\n\nlet currentPage;\nlet query;\n\nformEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = e.currentTarget.elements['search-text'].value.trim();\n\n  if (!query) {\n    return iziToast.info({\n      message: 'Введіть запит',\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n  }\n\n  clearGallery();\n  hideLoadMoreButton();\n  currentPage = 1;\n\n  try {\n    showLoader(currentPage);\n    const { hits, totalHits, error } = await getImagesByQuery(query, currentPage);\n\n    if (error) return;\n    if (hits.length > 0) {\n      createGallery(hits);\n\n      // якщо всі результати влізли на одну сторінку → сховати кнопку\n      if (currentPage >= MAX_PAGE) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"You've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n    checkVisibleLoadBtn(currentPage);\n  }\n});\n\nbtnLdMrEl.addEventListener('click', async e => {\n  currentPage += 1;\n  hideLoadMoreButton();\n\n  try {\n    showLoader(currentPage);\n    const { hits, error } = await getImagesByQuery(query, currentPage);\n\n    if (error) return;\n    if (hits.length > 0) {\n      updateGallery(hits);\n      scrollAfterUpdate();\n\n      // якщо дійшли до останньої сторінки\n      if (currentPage >= MAX_PAGE) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"You've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n    checkVisibleLoadBtn(currentPage);\n  }\n});\n"],"names":["MAX_PAGE","getImagesByQuery","query","page","axios","params","res","total","totalHits","hits","iziToast","error","spanEl","ulElem","btnLdMrEl","gallery","SimpleLightbox","createGallery","images","markup","templatesImage","updateGallery","clearGallery","showLoader","currentPage","hideLoader","checkVisibleLoadBtn","showLoadMoreButton","hideLoadMoreButton","scrollAfterUpdate","rect","templateImage","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgs","formEl","e"],"mappings":"owBAIO,IAAIA,EAAW,EAEf,eAAeC,EAAiBC,EAAOC,EAAM,CAClDC,EAAM,SAAS,QAAU,sBACzB,MAAMC,EAAS,CACb,IAAK,qCACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,CACV,EAEE,GAAI,CACF,MAAMG,EAAM,MAAMF,EAAM,IAAI,QAAS,CAAE,OAAAC,CAAM,CAAE,EAEzC,CAAE,MAAAE,EAAO,UAAAC,EAAW,KAAAC,CAAI,EAAKH,EAAI,KAMvC,OAHAN,EAAW,KAAK,KAAKQ,EAAYH,EAAO,QAAQ,EAG5C,CAACI,GAAQA,EAAK,SAAW,GAC3BC,EAAS,QAAQ,CACf,MAAO,IACP,QAAS,8DACT,MAAO,MACP,SAAU,WACV,aAAc,QACd,WAAY,OACpB,CAAO,EAEM,CAAE,MAAAH,EAAO,UAAAC,EAAW,KAAM,CAAA,EAAI,MAAO,OAGvC,CAAE,MAAAD,EAAO,UAAAC,EAAW,KAAAC,EAAM,MAAO,IAAI,CAE7C,OAAQE,EAAO,CACd,OAAAD,EAAS,MAAM,CACb,MAAO,QACP,QAASC,EAAM,QACf,MAAO,MACP,SAAU,WACV,aAAc,QACd,WAAY,OAClB,CAAK,EAEM,CAAE,MAAO,EAAG,UAAW,EAAG,KAAM,CAAA,EAAI,MAAOA,EAAM,QACzD,CACH,CCjDA,MAAMC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAS,SAAS,cAAc,UAAU,EAC1CC,EAAY,SAAS,cAAc,YAAY,EAEjDF,IACFA,EAAO,OAAS,IAGlB,MAAMG,EAAU,IAAIC,EAAe,kBAAmB,CACpD,aAAc,MACd,aAAc,GAChB,CAAC,EAEM,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASC,EAAeF,CAAM,EACpCL,EAAO,mBAAmB,aAAcM,CAAM,EAE9CJ,EAAQ,QAAO,CACjB,CAEO,SAASM,EAAcH,EAAQ,CACpC,MAAMC,EAASC,EAAeF,CAAM,EACpCL,EAAO,mBAAmB,YAAaM,CAAM,EAE7CJ,EAAQ,QAAO,CACjB,CAEO,SAASO,GAAe,CAC7BT,EAAO,UAAY,EACrB,CAEO,SAASU,EAAWC,EAAa,CACtCZ,EAAO,OAAS,GACZY,EAAc,GAChBZ,EAAO,UAAU,IAAI,kBAAkB,CAE3C,CAEO,SAASa,GAAa,CAC3Bb,EAAO,OAAS,EAClB,CAEO,SAASc,EAAoBF,EAAa,CAC3CA,EAAcxB,EAChB2B,IACS3B,IACT4B,IACAlB,EAAS,KAAK,CACZ,QAAS,6DACT,MAAO,OACP,SAAU,WACV,aAAc,OACpB,CAAK,EAEL,CAEO,SAASmB,GAAoB,CAGlC,IAAIC,EAFWjB,EAAO,cAAc,eAAe,EAEjC,wBAElB,OAAO,SAAS,CACd,IAAKiB,EAAK,OAAS,EACnB,KAAM,EACN,SAAU,QACd,CAAG,CACH,CAEA,SAASH,GAAqB,CAC5Bb,EAAU,UAAU,IAAI,YAAY,CACtC,CAEO,SAASc,GAAqB,CACnCd,EAAU,UAAU,OAAO,YAAY,CACzC,CAEA,SAASiB,EAAcC,EAAK,CAC1B,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGP,EACJ,MAAO;AAAA,kCACyBE,CAAa;AAAA;AAAA;AAAA,aAGlCD,CAAY;AAAA,aACZE,CAAI;AAAA;AAAA;AAAA,oCAGmBC,CAAK;AAAA,oCACLC,CAAK;AAAA,uCACFC,CAAQ;AAAA,wCACPC,CAAS;AAAA;AAAA,CAGjD,CAEA,SAASnB,EAAeoB,EAAM,CAC5B,OAAOA,EAAK,IAAIT,CAAa,EAAE,KAAK;AAAA,CAAI,CAC1C,CC/FA,MAAMU,EAAS,SAAS,cAAc,OAAO,EACvC3B,EAAY,SAAS,cAAc,YAAY,EAErD,IAAIU,EACAtB,EAEJuC,EAAO,iBAAiB,SAAU,MAAMC,GAAK,CAI3C,GAHAA,EAAE,eAAc,EAChBxC,EAAQwC,EAAE,cAAc,SAAS,aAAa,EAAE,MAAM,OAElD,CAACxC,EACH,OAAOQ,EAAS,KAAK,CACnB,QAAS,gBACT,MAAO,MACP,SAAU,WACV,aAAc,QACd,WAAY,OAClB,CAAK,EAGHY,IACAM,IACAJ,EAAc,EAEd,GAAI,CACFD,EAAWC,CAAW,EACtB,KAAM,CAAE,KAAAf,EAAM,UAAAD,EAAW,MAAAG,CAAK,EAAK,MAAMV,EAAiBC,EAAOsB,CAAW,EAE5E,GAAIb,EAAO,OACPF,EAAK,OAAS,IAChBQ,EAAcR,CAAI,EAGde,GAAexB,IACjB4B,IACAlB,EAAS,KAAK,CACZ,QAAS,4CACT,SAAU,UACpB,CAAS,GAGN,OAAQC,EAAO,CACdD,EAAS,MAAM,CACb,QAASC,EAAM,QACf,MAAO,MACP,SAAU,WACV,aAAc,QACd,WAAY,OAClB,CAAK,EACDiB,GACJ,QAAY,CACRH,IACAC,EAAoBF,CAAW,CAChC,CACH,CAAC,EAEDV,EAAU,iBAAiB,QAAS,MAAM4B,GAAK,CAC7ClB,GAAe,EACfI,IAEA,GAAI,CACFL,EAAWC,CAAW,EACtB,KAAM,CAAE,KAAAf,EAAM,MAAAE,CAAO,EAAG,MAAMV,EAAiBC,EAAOsB,CAAW,EAEjE,GAAIb,EAAO,OACPF,EAAK,OAAS,IAChBY,EAAcZ,CAAI,EAClBoB,IAGIL,GAAexB,IACjB4B,IACAlB,EAAS,KAAK,CACZ,QAAS,4CACT,SAAU,UACpB,CAAS,GAGN,OAAQC,EAAO,CACdD,EAAS,MAAM,CACb,QAASC,EAAM,QACf,MAAO,MACP,SAAU,WACV,aAAc,QACd,WAAY,OAClB,CAAK,EACDiB,GACJ,QAAY,CACRH,IACAC,EAAoBF,CAAW,CAChC,CACH,CAAC"}